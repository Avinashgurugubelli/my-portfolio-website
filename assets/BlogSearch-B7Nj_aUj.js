import{o as L,j as e,p as E,a3 as H,a4 as k,u as A,r as l,A as P,m as b,N as G,B as R,S as $,I as D,C as F,b as q,d as U,e as _,f as z,i as M}from"./index-COMSTL8B.js";import{B as j}from"./blogService-CjIYV27M.js";import{A as O,C as V}from"./calendar-B-QMaLpR.js";import{U as Q}from"./user-BYf1-yZS.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=L("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),K=H("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function w({className:p,variant:m,...h}){return e.jsx("div",{className:E(K({variant:m}),p),...h})}const te=()=>{const[p,m]=k(),h=A(),[o,I]=l.useState(p.get("q")||"");l.useState([]),l.useState(!1);const[W,C]=l.useState(null),[x,S]=l.useState([]);l.useEffect(()=>{(async()=>{try{const i=await j.fetchBlogsData();C(i);const c=[];for(const a of i.categories)if(a.indexUrl)try{const s=await j.fetchNestedBlogIndex(a.indexUrl),r=(n,u=[])=>{n.forEach(d=>{const v=[...u,d.title||""];c.push({item:d,categoryId:a.id,categoryTitle:a.title,path:v,relevanceScore:0}),d.type==="directory"&&d.children&&r(d.children,v)})};s.children&&r(s.children)}catch(s){console.error(`Failed to load nested index for ${a.id}:`,s)}else a.children&&a.children.forEach(s=>{const r={id:s.id,type:"file",path:s.path||s.contentPath||"",title:s.title||"",description:s.description,date:s.date};c.push({item:r,categoryId:a.id,categoryTitle:a.title,path:[s.title||""],relevanceScore:0})});S(c)}catch(i){console.error("Failed to load blogs data:",i)}})()},[]);const f=l.useMemo(()=>{if(!o.trim()||x.length===0)return[];const t=o.toLowerCase(),i=t.split(/\s+/).filter(a=>a.length>0);return x.map(a=>{let s=0;const r=a.item,n=(r==null?void 0:r.title)||"";n.toLowerCase().includes(t)&&(s+=10),i.forEach(g=>{n.toLowerCase().includes(g)&&(s+=5)});const u=(r==null?void 0:r.description)||"";return u.toLowerCase().includes(t)&&(s+=8),i.forEach(g=>{u.toLowerCase().includes(g)&&(s+=3)}),r.type==="file"&&r.tags&&Array.isArray(r.tags)&&r.tags.forEach(g=>{const N=g||"";N.toLowerCase().includes(t)&&(s+=6),i.forEach(B=>{N.toLowerCase().includes(B)&&(s+=2)})}),((r==null?void 0:r.author)||"").toLowerCase().includes(t)&&(s+=4),(a.categoryTitle||"").toLowerCase().includes(t)&&(s+=3),{...a,relevanceScore:s}}).filter(a=>a.relevanceScore>0).sort((a,s)=>s.relevanceScore-a.relevanceScore)},[o,x]);l.useEffect(()=>{o.trim()?m({q:o}):m({})},[o,m]);const y=(t,i)=>{if(!t||!i.trim())return t||"";const c=i.toLowerCase().split(/\s+/).filter(r=>r.length>0);let a=t;return c.forEach(r=>{const n=new RegExp(`(${r})`,"gi");a=a.replace(n,"|||HIGHLIGHT_START|||$1|||HIGHLIGHT_END|||")}),a.split(/\|\|\|HIGHLIGHT_START\|\|\||HIGHLIGHT_END\|\|\|/).map((r,n)=>n%2===1?e.jsx("mark",{className:"bg-yellow-200 dark:bg-yellow-800 px-1 rounded",children:r},n):r)},T=t=>{const i=j.findItemPath(x.filter(c=>c.categoryId===t.categoryId).map(c=>c.item),t.item);if(i){const c=i.join("/");h(`/blogs/${t.categoryId}/${c}`)}else h(`/blogs/${t.categoryId}`)};return e.jsx(P,{children:e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"min-h-screen bg-background text-foreground",children:[e.jsx(G,{}),e.jsx("main",{className:"pt-[120px] pb-20",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>h("/blogs"),className:"gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),"Back to Blogs"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Search Blogs"}),e.jsx("p",{className:"text-muted-foreground",children:"Find articles by title, content, tags, or author"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{type:"text",placeholder:"Search articles...",value:o,onChange:t=>I(t.target.value),className:"pl-10 h-12 text-lg",autoFocus:!0})]})]}),e.jsxs("div",{className:"space-y-6",children:[o.trim()&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[f.length," result",f.length!==1?"s":"",' for "',o,'"']}),f.map((t,i)=>e.jsx(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:i*.1},children:e.jsxs(F,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>T(t),children:[e.jsxs(q,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(U,{className:"text-xl mb-2",children:y(t.item.title,o)}),e.jsx(_,{className:"text-base mb-3",children:t.item.description&&y(t.item.description,o)})]}),e.jsx(w,{variant:"secondary",children:t.categoryTitle})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[t.item.author&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),e.jsx("span",{children:t.item.author})]}),(t.item.date||t.item.type==="file"&&t.item.createdOn)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),e.jsx("span",{children:t.item.date||(t.item.type==="file"?t.item.createdOn:"")})]})]})]}),t.item.type==="file"&&t.item.tags&&t.item.tags.length>0&&e.jsx(z,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(J,{className:"h-3 w-3 text-muted-foreground"}),t.item.tags.map((c,a)=>e.jsx(w,{variant:"outline",className:"text-xs",children:y(c,o)},a))]})})]})},`${t.categoryId}-${t.item.id}`)),o.trim()&&f.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("p",{className:"text-muted-foreground text-lg",children:['No articles found for "',o,'"']}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Try different keywords or browse categories"})]})]})]})}),e.jsx(M,{})]})})};export{te as default};
