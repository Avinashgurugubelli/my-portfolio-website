import{g as v,u as y,r as a,h as B,j as e,A as I,m as S,N as P,B as z,F as w}from"./index-CqrC0tq-.js";import{u as E}from"./index-BsnAUaby.js";import{R as F,a as p,B as k,b as A,c as R,E as C}from"./EmptyBlogState-fGJhQIfn.js";import{B as o}from"./blogService-DqGBhISM.js";import{A as L}from"./arrow-left-B2UC6q9w.js";const J=()=>{const{categoryId:m,"*":l}=v(),g=y(),[h,r]=a.useState(null),[j,c]=a.useState(""),[n,x]=a.useState([]),i=B.categories.find(s=>s.id===m),{data:d,isLoading:b}=E({queryKey:["blogIndex",i==null?void 0:i.indexUrl],queryFn:()=>o.fetchNestedBlogIndex(i.indexUrl),enabled:!!(i!=null&&i.indexUrl),staleTime:1e3*60*60}),f=s=>{for(const t of s){if(t.type==="file")return t;if(t.type==="directory"&&t.children){const u=f(t.children);if(u)return u}}return null};a.useEffect(()=>{if(d)x(d.children||[]);else if(i!=null&&i.children){const s=i.children.map(t=>({id:t.id,type:"file",path:t.path||t.contentPath||"",title:t.title,description:t.description,date:t.date}));x(s)}},[d,i]),a.useEffect(()=>{if(n.length>0&&!l){const s=f(n);s&&(r(s),c(s.type==="file"?s.path:s.id))}},[n,l]),a.useEffect(()=>{if(l&&n.length>0){const s=l.split("/").filter(Boolean),t=o.findBlogItemByPath(n,s);t&&(r(t),c(t.type==="file"?t.path:t.id))}},[l,n]);const N=s=>{r(s),c(s.type==="file"?s.path:s.id);const t=o.generateBlogPath(s);window.history.replaceState(null,"",`/blogs/${m}/${t}`)};return i?b?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("p",{children:"Loading blog structure..."})}):e.jsx(I,{children:e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"min-h-screen bg-background text-foreground relative",children:[e.jsx(P,{}),e.jsx("main",{className:"pt-[120px]",children:e.jsxs("div",{className:"max-w-7xl mx-auto min-h-[calc(100vh-120px)]",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(z,{variant:"outline",size:"sm",onClick:()=>g("/blogs"),className:"gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Back to Blogs"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:i.title}),e.jsx("p",{className:"text-muted-foreground",children:i.description})]})]})}),n.length>0?e.jsxs(F,{direction:"horizontal",className:"min-h-[calc(100vh-200px)]",children:[e.jsx(p,{defaultSize:25,minSize:20,maxSize:40,children:e.jsx(k,{blogItems:n,onItemClick:N,selectedPath:j})}),e.jsx(A,{withHandle:!0}),e.jsx(p,{defaultSize:75,children:e.jsx("div",{className:"flex flex-col h-full",children:h?e.jsx(R,{selectedItem:h}):e.jsx(C,{})})})]}):e.jsx("div",{className:"flex items-center justify-center h-[400px]",children:e.jsx("p",{className:"text-muted-foreground",children:"No content available"})})]})}),e.jsx(w,{})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("p",{children:"Category not found"})})};export{J as default};
