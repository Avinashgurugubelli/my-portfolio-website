import{o as S,j as e,p as T,a3 as B,a4 as L,u as E,r as d,A as H,m as j,N as k,B as A,S as P,I as G,C as R,b as $,d as D,e as F,f as q,i as U}from"./index-Dyyn7rfQ.js";import{B as v}from"./blogService-Czu4uxff.js";import{A as _,C as z}from"./calendar-sZSt3MGx.js";import{U as M}from"./user-Bq3pHqHE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=S("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),V=B("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function N({className:p,variant:h,...x}){return e.jsx("div",{className:T(V({variant:h}),p),...x})}const Y=()=>{const[p,h]=L(),x=E(),[o,b]=d.useState(p.get("q")||"");d.useState([]),d.useState(!1);const[Q,w]=d.useState(null),[f,I]=d.useState([]);d.useEffect(()=>{(async()=>{try{const i=await v.fetchBlogsData();w(i);const c=[];for(const a of i.categories)if(a.indexUrl)try{const s=await v.fetchNestedBlogIndex(a.indexUrl),r=(l,u=[])=>{l.forEach(n=>{const m=[...u,n.title];c.push({item:n,categoryId:a.id,categoryTitle:a.title,path:m,relevanceScore:0}),n.type==="directory"&&n.children&&r(n.children,m)})};s.children&&r(s.children)}catch(s){console.error(`Failed to load nested index for ${a.id}:`,s)}else a.children&&a.children.forEach(s=>{const r={id:s.id,type:"file",path:s.path||s.contentPath||"",title:s.title,description:s.description,date:s.date};c.push({item:r,categoryId:a.id,categoryTitle:a.title,path:[s.title],relevanceScore:0})});I(c)}catch(i){console.error("Failed to load blogs data:",i)}})()},[]);const g=d.useMemo(()=>{if(!o.trim()||f.length===0)return[];const t=o.toLowerCase(),i=t.split(/\s+/).filter(a=>a.length>0);return f.map(a=>{var l,u;let s=0;const r=a.item;return r.title.toLowerCase().includes(t)&&(s+=10),i.forEach(n=>{r.title.toLowerCase().includes(n)&&(s+=5)}),(l=r.description)!=null&&l.toLowerCase().includes(t)&&(s+=8),i.forEach(n=>{var m;(m=r.description)!=null&&m.toLowerCase().includes(n)&&(s+=3)}),r.type==="file"&&r.tags&&r.tags.forEach(n=>{n.toLowerCase().includes(t)&&(s+=6),i.forEach(m=>{n.toLowerCase().includes(m)&&(s+=2)})}),(u=r.author)!=null&&u.toLowerCase().includes(t)&&(s+=4),a.categoryTitle.toLowerCase().includes(t)&&(s+=3),{...a,relevanceScore:s}}).filter(a=>a.relevanceScore>0).sort((a,s)=>s.relevanceScore-a.relevanceScore)},[o,f]);d.useEffect(()=>{o.trim()?h({q:o}):h({})},[o,h]);const y=(t,i)=>{if(!i.trim())return t;const c=i.toLowerCase().split(/\s+/).filter(r=>r.length>0);let a=t;return c.forEach(r=>{const l=new RegExp(`(${r})`,"gi");a=a.replace(l,"|||HIGHLIGHT_START|||$1|||HIGHLIGHT_END|||")}),a.split(/\|\|\|HIGHLIGHT_START\|\|\||HIGHLIGHT_END\|\|\|/).map((r,l)=>l%2===1?e.jsx("mark",{className:"bg-yellow-200 dark:bg-yellow-800 px-1 rounded",children:r},l):r)},C=t=>{const i=v.findItemPath(f.filter(c=>c.categoryId===t.categoryId).map(c=>c.item),t.item);if(i){const c=i.join("/");x(`/blogs/${t.categoryId}/${c}`)}else x(`/blogs/${t.categoryId}`)};return e.jsx(H,{children:e.jsxs(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"min-h-screen bg-background text-foreground",children:[e.jsx(k,{}),e.jsx("main",{className:"pt-[120px] pb-20",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>x("/blogs"),className:"gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Back to Blogs"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Search Blogs"}),e.jsx("p",{className:"text-muted-foreground",children:"Find articles by title, content, tags, or author"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(G,{type:"text",placeholder:"Search articles...",value:o,onChange:t=>b(t.target.value),className:"pl-10 h-12 text-lg",autoFocus:!0})]})]}),e.jsxs("div",{className:"space-y-6",children:[o.trim()&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[g.length," result",g.length!==1?"s":"",' for "',o,'"']}),g.map((t,i)=>e.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:i*.1},children:e.jsxs(R,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>C(t),children:[e.jsxs($,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(D,{className:"text-xl mb-2",children:y(t.item.title,o)}),e.jsx(F,{className:"text-base mb-3",children:t.item.description&&y(t.item.description,o)})]}),e.jsx(N,{variant:"secondary",children:t.categoryTitle})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[t.item.author&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"h-3 w-3"}),e.jsx("span",{children:t.item.author})]}),(t.item.date||t.item.type==="file"&&t.item.createdOn)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),e.jsx("span",{children:t.item.date||(t.item.type==="file"?t.item.createdOn:"")})]})]})]}),t.item.type==="file"&&t.item.tags&&t.item.tags.length>0&&e.jsx(q,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(O,{className:"h-3 w-3 text-muted-foreground"}),t.item.tags.map((c,a)=>e.jsx(N,{variant:"outline",className:"text-xs",children:y(c,o)},a))]})})]})},`${t.categoryId}-${t.item.id}`)),o.trim()&&g.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("p",{className:"text-muted-foreground text-lg",children:['No articles found for "',o,'"']}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"Try different keywords or browse categories"})]})]})]})}),e.jsx(U,{})]})})};export{Y as default};
